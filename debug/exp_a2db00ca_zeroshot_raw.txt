```python
def is_multiply_prime(a):
    """Return True if a is a product of exactly three prime numbers (with repetition allowed)."""
    if not isinstance(a, int) or a <= 0:
        return False

    n = a
    count = 0
    d = 2
    while d * d <= n:
        while n % d == 0:
            n //= d
            count += 1
            if count > 3:
                return False
        d += 1
    if n > 1:
        count += 1
    return count == 3
```