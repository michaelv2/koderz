```python
def is_multiply_prime(a):
    """Return True if a is the product of exactly three prime factors (counting multiplicity)."""
    if not isinstance(a, int) or a < 2:
        return False
    n = a
    count = 0
    p = 2
    while p * p <= n:
        while n % p == 0:
            count += 1
            n //= p
            if count > 3:
                return False
        p += 1 if p == 2 else 2  # skip even numbers after 2
    if n > 1:
        count += 1
    return count == 3
```